---
name: "PR Terraform Plan"

on:
  pull_request:
      branches: 'main'
permissions:
  id-token: write
  contents: read
  pull-requests: write

jobs:
  dev:
      runs-on: ubuntu-latest
      defaults:
        run:
          working-directory: ./dev
      env:
        ARM_CLIENT_ID: "${{ secrets.AZURE_CLIENT_ID }}"
        ARM_SUBSCRIPTION_ID: "${{ secrets.AZURE_SUBSCRIPTION_ID }}"
        ARM_TENANT_ID: "${{ secrets.AZURE_TENANT_ID }}"
      steps:                  
          - name: Terraform run
            uses: ./terraform-action
            with:
              github_token: ${{ secrets.GITHUB_TOKEN }}
              tf_api_token: ${{ secrets.TF_API_TOKEN }}